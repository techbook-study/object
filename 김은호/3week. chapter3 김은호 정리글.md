## 정리
객체지향 패러다임의 관점에서의 핵심은 역할(role), 책임(resposibility), 협력(collaboration)입니다.

### 협력
협력은 객체지향 세계에서 기능을 구현할 수 있는 유일한 방법이며, 이는 **메시지 전송**을 통해 가능합니다. 

#### 캡슐화
메시지를 수신 받은 객체는 메서드를 실행해 요청에 응답합니다. 이때 객체 스스로 메시지를 처리할 방법을 선택하게 되며, 메시지를 전송한 객체는 그 처리 방법을 몰라도 됩니다. 
이렇게 객체를 자율적인 존재로 만드는 것을 **캡슐화**라고 하며 이를 통해 **변경에 대한 파급 효과를 줄일 수 있고 변경하기 쉬운 객체**를 만들 수 있게 됩니다. 

#### 문맥
객체의 행동을 결정하는 것이 협력이고, 객체의 상태를 결정하는 것은 행동이 됩니다.
결과적으로 객체가 참여하는 협력이 객체를 구성하는 행동과 상태를 모두 결정하게 됩니다. 따라서 협력은 객체를 설계하는데 필요한 일종의 문맥을 제공합니다.

### 책임
책임이란 객체에 의해 정의되는 응집도 있는 행위의 집합으로, 객체가 유지해야하는 정보와 수행할 수 있는 행동에 대해 개략적으로 서술한 문장입니다. 

크레이그 라만은 책임을 크게 하는 것(doing)과 아는 것(knowing)의 두가지 범주로 세분화합니다.

**하는 것(doing)**
객체를 생성하거나 계산을 수행하는 등의 스스로 하는 것
다른 객체의 행동을 시작시키는 것
다른 객체의 활동을 제어하고 조절하는 것

**아는 것(knowing)**
사적인 정보에 관해 아는 것
관련된 객체에 관해 아는 것
자신이 유도하거나 계산할 수 있는 것에 관해 아는 것

이 개념을 토대로 영화 예매 시스템 기능을 CRC카드로 설명하면 다음과 같습니다. 

<img src="https://github.com/OiKimiO/object/assets/53805469/dd58b027-a57e-4f30-bea6-da83b5b443a6" style="width:100%;" />
Screening이  reserve메시지를 수신하고 movie를 인스턴스 변수로 포함하는 이유는 **협력 안에서 영화를 예매할 책임을 수행**하기 때문입니다.
Movie가 calculateMovieFee 메시지를 수신할 수 있고 fee와 discountPolicy를 속성으로 가지는 이유는 **협력안에서 가격을 계산할 책임을 할당**받았기 때문입니다.
Screening과 Movie는 책임의 관점에서 자신들이 맡은 책임을 다할 수 있는 책임(**아는 것**)과 자신들이 할 수 없는 작업을 도와줄 객체에게 메시지를 전달하는 책임(**하는 것**)을 명확히 알고 있습니다.
이것이 가능한 이유는 협력안에서 적절한 책임을 제공했기때문에 가능한 것입니다.

#### 책임 주도 설계
책임을 찾고 책임을 수행할 적절한 객체를 찾아 책임을 할당하는 방식으로 협력을 설계하는 방식을 책임 주도 설계라고 합니다. 
책임을 할당할 때 고려할 2가지 사항은 다음과 같습니다.

**1. 메시지가 객체를 결정한다.**
메시지가 객체를 선택하게 만들어야 하는 2가지 중요한 이유가 있습니다. 

1) 객체가 최소한의 인터페이스를 가질 수 있게 만듭니다.
필요한 메시지가 추가되기 전까진 퍼블릭 인터페이스에 어떤 것도 추가하지 않기에 객체는 애플리케이션이 크지도 작지도 않은 꼭 필요한 크기의 퍼블릭 인터페이스를 가질 수 있습니다.

2) 객체는 충분히 추상적인 인터페이스를 가질 수 있게 만듭니다. 
메시지 외부의 객체가 요청하는 무언가를 의미하기에 메시지를 먼저 식별하면 무엇을 수행할지에 초점을 맞추는 인터페이스를 얻을 수 있습니다.

**2. 행동이 상태를 결정한다.** 
행동이 상태를 결정하기에 이르게 퍼블릭 구현을 막을 수 있습니다.
이로 인해 객체의 캡슐화를 지킬 수 있게 됩니다.

### 역할
객체가 어떤 특정한 협력안에서 수행하는 책임의 집합을 역할이라고 부릅니다. 

#### 객체 대 역할
객체와 역할을 구분하는 기준은 책임을 수행하는 대상이 한 종류라면 간단히 객체로 간주하는 것이고, 여러 종류의 객체들이 참여할 수 있다면 역할이라고 보면 됩니다.
객체와 역할의 구분의 시작은 적절한 책임과 협력의 큰 그림이 정해지고 난 뒤에 구분을 시작하면 좋습니다. 
특히 구분 이후에도 애매한 경우엔 객체로 만들고, 반복적으로 책임과 협력을 정제해가면서 필요한 순간에 객체로 부터 역할을 분리해내는 것이 가장 좋은 방법입니다. 

#### 역할과 추상화
추상화 설계가 가질 수 있는 장점은 2가지입니다. 

**1. 추상화 계층만을 이용하면 중요한 정책을 상위 수준에서 단순화 할 수 있습니다.**
<img src="https://github.com/OiKimiO/object/assets/53805469/73661517-06ef-4604-ab53-9471db817be4" style="width:100%;" />
chapter2인 영화 예매 시스템의 모든 객체와 기능을 표현했다면 업무 플로우를 설명이 어려울 것입니다. 
왜냐하면 너무 세부적인 내용까지 다 포함을 하기 때문입니다.

<img src="https://github.com/OiKimiO/object/assets/53805469/f7a76fec-ab98-4e4d-9744-73ef23074e8d" style="width:100%;" />
하지만 행동을 기반으로 한 추상화에 집중을 한다면 내용 파악이 좀 더 쉬워집니다.

<img src="https://github.com/OiKimiO/object/assets/53805469/69be42d0-ce54-4d3a-a1f7-54e154d24300" style="width:100%;" />
또한 추상화와 관련된 세부적인 사항을 확인하고 싶은 경우 개별적으로 쉽게 파악할 수 있게 됩니다. 

**2. 설계가 좀 더 유연해집니다.**
협력안에서 동일한 책임을 수행하는 객체들은 동일한 역할을 수행하기에 서로 대체가 가능해집니다.

## 읽고 느낀점
시스템을 만들면서 항상 최대한 빠르게 **추상화**를 하는 것이 좋다 생각했습니다. 
왜냐하면 추상화라는 과정이 **코드를 깔끔**하게 만든다는 생각을 했기 때문입니다. 
하지만 책에선 너무 이른 추상화는 좋지 않다고 말합니다. 
오히려 시스템의 기능을 명확히 파악한 뒤 **협력 관계**에 맞는 **책임과 상태**를 적용하라고합니다. 
그리고 이후엔 공통된 책임이 반복되면 공통된 책임을 **역할**로 표현하라 합니다. 
결국은 제가 이번장까지 읽으며 핵심이라 느낀 부분은 **추상화**는 최대한 늦게하고, 그 이전까진 **시스템의 협력관계 파악**과 **협력에 맞는 객체 구현**을 먼저 해야겠다는 생각을 했습니다. 